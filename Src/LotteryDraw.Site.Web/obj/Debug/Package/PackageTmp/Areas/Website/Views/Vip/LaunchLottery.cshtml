@{
    ViewBag.Title = "LaunchLottery";
    Layout = "~/Areas/Website/Views/Shared/_Layout_Vip.cshtml";
}
@using Webdiyer.WebControls.Mvc
@using LotteryDraw.Component.Tools
@model LotteryDraw.Site.Models.PrizeOrderDetailView

@section  LeftMenuItems{
    @Html.Partial("VipNavPartial")
}

@section  BreadCrumbs{
    &gt;
    <label>发布抽奖</label>
}

@using (Html.BeginForm("LaunchLottery", "Vip", FormMethod.Post, new { id = "prizeForm", enctype = "multipart/form-data" }))
{
    //enctype = "multipart/form-data"
    @Html.HiddenFor(m => m.PrizeOrderView.ScopeType, new { Id = "hidnScopeType" })
    @Html.HiddenFor(m => m.PrizeOrderView.ScopeProvince, new { Id = "hidnScopeProvince" })
    @Html.HiddenFor(m => m.PrizeOrderView.ScopeAreaCity, new { Id = "hidnScopeAreaCity" })
    @Html.HiddenFor(m => m.PrizeOrderView.MinLuckyCount, new { Id = "hidnMinLuckyCount" })
    @Html.HiddenFor(m => m.PrizeOrderView.RevealType, new { Id = "hidnRevealType" });
    //@Html.HiddenFor(m => m.PrizeOrderView.RevealTypeNum, new { Id = "hidnRevealTypeNum" });
    //@Html.HiddenFor(m => m.PrizeOrderView.AnswerRevealConditionTypeNum, new { Id="hidnAnswerRevealConditionTypeNum" });
    @Html.HiddenFor(m => m.PrizeOrderView.AnswerRevealConditionType, new { Id = "hidnAnswerRevealConditionType" });
    @Html.HiddenFor(m => m.PrizeOrderView.Answer, new { Id = "hidnAnswer" });
    @Html.HiddenFor(m => m.PrizeOrderView.AnswerOptions, new { Id = "hidnAnswerOptions" });
    @Html.HiddenFor(model => model.PrizeOrderView.PrizeId, new { Id = "hidnPrizeId" });
    <table class="message_table">
        <tbody>
            @*@if (ViewBag.IsPostBack != null && (bool)ViewBag.IsPostBack)
            {
                <tr>
                    <td colspan="2" style="text-align: center; color: #f00;">@ViewBag.Message</td>
                </tr>
            }*@
            <tr rtype="no-change">
                <td class="text">奖品名称</td>
                <td class="input">
                    @Html.TextBoxFor(model => model.PrizeView.Name, new { @class = "input-text", Id = "PrizeName", placeholder = "奖品名称" })
                    <span class="info">*</span>
                </td>
            </tr>
            <tr rtype="no-change">
                <td class="text">奖品图片</td>
                <td class="input">
                    <input type="file" id="prizePhoto" name="PrizePhoto" />
                    <div id="divPreview" style="background-color: #ccc; text-align: center; vertical-align: middle;">
                        <img id="imgHeadPhoto" style="display: none; max-width: 400px;" alt="" />
                    </div>
                    @*<input type="button" value="浏览" style="padding:5px;width:60px;" id="btnBrowerPhoto" />
                    <input type="file" id="prizePhoto" name="PrizePhoto" />*@
                </td>
            </tr>
            <tr rtype="no-change">
                <td class="text">描述：</td>
                <td class="input">
                    @Html.TextAreaFor(model => model.PrizeView.Description, new { @class = "textarea-text", Id = "PrizeDescription", cols = "50", rows = "6", placeholder = "描述" })<span class="info">*</span>
                    <br />
                </td>
            </tr>
            <tr rtype="no-change">
                <td class="text">开奖类型：</td>
                <td class="input">
                    @*@Html.DropDownList("slLauchType",(SelectList)ViewBag.RevealTypeList)*@
                    <select id="slLauchType" name="selectRType">
                        <option value="" rtype="">请选择</option>
                        <option value="1" rtype="timing">定时开奖</option>
                        <option value="2" rtype="quota">定员开奖</option>
                        <option value="3" rtype="answer">答案开奖</option>
                        <option value="4" rtype="scene">实时开奖</option>
                    </select><span class="info">*</span>
                </td>
            </tr>
            <tr rtype="timing quota answer">
                <td class="text">抽奖范围：</td>
                <td class="input">
                    <select id="slScopeType" name="selectScopeType">
                        <option value="" scope-type="">请选择</option>
                        <option value="1" scope-type="global">全国</option>
                        <option value="2" scope-type="area-city">地级城市</option>
                    </select><span class="info">*</span>
                </td>
            </tr>
            <tr scope-type="area-city">
                <td class="text">开奖城市：</td>
                <td class="input">
                    <select name="loc_province" class="select" style="width: 80px;"></select>
                    <select name="loc_city" class="select" style="width: 100px;"></select>
                    <select name="loc_town" class="select" style="width: 120px; display: none;"></select>
                </td>
            </tr>
            <tr rtype="timing quota answer scene">
                <td class="text">中奖人数：</td>
                <td class="input">
                    @Html.TextBoxFor(m => m.PrizeOrderView.LuckyCount, new { @class = "input-text num", Id = "LuckyCount" })<span class="info">*</span>
                </td>
            </tr>
            <tr rtype="answer">
                <td class="text">开奖问题：</td>
                <td class="input">
                    @Html.TextAreaFor(m => m.PrizeOrderView.Question, new { @class = "textarea-text", Id = "Question", cols = "50", rows = "3", placeholder = "请填写开奖问题" })<span class="info">*</span>
                </td>
            </tr>
            <tr rtype="answer">
                <td class="text">开奖答案选项：</td>
                <td class="input">
                    <div style="float: left; line-height: 200px;">
                        @*@Html.TextAreaFor(m => m.Answer, new { @class = "textarea-text", cols = "50", rows = "3" })*@
                        <input type="text" class="input-text" id="txtAnswerOption" placeholder="请填写一个答案选项" />
                        <input type="button" class="" value="追加" style="padding: 5px; width: 60px;" id="btnAddAnswerOption" />
                    </div>
                    <div style="float: left;">
                        <div class="dropdown">
                        </div>
                    </div>
                    @Html.Hidden("AddedAnswerOptions")
                </td>
            </tr>
            <tr rtype="answer">
                <td class="text">开奖答案：</td>
                <td class="input">
                    <select id="slAnswer" name="slAnswer">
                        <option value="" selected>请选择</option>
                    </select><span class="info">*</span><input type="button" class="button orange" value="重置" id="btnResetAnswerOption" />
                </td>
            </tr>
            <tr rtype="answer">
                <td class="text">开奖条件：</td>
                <td class="input">
                    @*@Html.DropDownList("slLauchType",(SelectList)ViewBag.RevealTypeList)*@
                    <select id="slAnswerLauchType" name="AnswerLauchType">
                        <option value="" selected>请选择</option>
                        <option value="1" lt-condition="timing">定时</option>
                        <option value="2" lt-condition="quota">定员</option>
                    </select><span class="info">*</span>
                </td>
            </tr>
            <tr rtype="quota" lt-condition="quota">
                <td class="text">总人数：</td>
                <td class="input">
                    @Html.TextBoxFor(m => m.PrizeOrderView.PoolCount, new { @class = "input-text num", Id = "PoolCount" })<span class="info">*</span>
                </td>
            </tr>
            <tr rtype="timing scene" lt-condition="timing">
                <td class="text">开奖时间：</td>
                <td class="input">
                    @Html.TextBoxFor(m => m.PrizeOrderView.LaunchTime, new { @class = "input-text launchtime", Id = "LaunchTime", @readonly = "readonly" })<span class="info">*</span>
                </td>
            </tr>
            @*<tr>
                    <td class="text">中奖最低人数：</td>
                    <td class="input">
                        @Html.TextBoxFor(m => m.PrizeOrderView.MinLuckyCount, new { @class = "input-text num" })<span class="info">*</span>
                    </td>
                </tr>*@
            <tr rtype="no-change">
                <td class="text"></td>
                <td class="input">
                    @Html.MvcCaptcha(new MvcCaptchaOptions
               {
                   DelayLoad = false, //若要启用Ajax延迟加载验证码图片功能，则需要设置MvcCaptchaOptions属性的DelayLoad为true
                   ValidationInputBoxId = "captchaInput", //验证码输入文本框的客户端ID
                   CaptchaImageContainerId = "imgContainer" //包含验证码图片的容器元素的客户端ID
               })
                    <span id="imgContainer"></span>
                    <br />
                    <div>请输入上边图片中的文字：</div>
                    <input type="text" class="input-text" name="_mvcCaptchaText" placeholder="输入验证码" id="captchaInput" data-val="true" data-val-required="验证码不能为空" />
                </td>
            </tr>
            <tr rtype="no-change">
                <td class="text"></td>
                <td class="submint">
                    <input type="button" id="btnSubmitForm" value="发布" class="submit button orange"></td>
            </tr>
        </tbody>
    </table>
}
@using (Html.BeginForm("SavePhotoAjax", "Vip", FormMethod.Post, new { id = "photoForm", enctype = "multipart/form-data", style = "display:none" }))
{
    @Html.Hidden("PrizeId")
    <table class="message_table">
        <tr>
            <td class="text">奖品图片</td>
            <td class="input">
                <input type="file" id="prizePhoto" name="PrizePhoto" />
                <div id="divPreview" style="background-color: #ccc; text-align: center; vertical-align: middle;">
                    <img id="imgHeadPhoto" style="display: none; max-width: 400px;" alt="" />
                </div>
            </td>
        </tr>
        <tr>
            <td class="text"></td>
            <td class="submint">
                <input type="submit" value="上传" class="submit button orange"></td>
        </tr>
    </table>
}
<div class="layer-box">
    <ul class="layer_notice" style="display: none; padding: 10px;">
        <li>
            <label>友情提示：</label></li>
        <li>1. 您将要进行的是“答案抽奖”的开奖方式。</li>
        <li>2. 您请务必设置开奖题目和答案。</li>
    </ul>
</div>
@section scripts{
    @Html.Partial("PostBackMessage")
    <script src="~/Scripts/jquery.form.js"></script>
    <script src="~/Scripts/jquery.validate.js"></script>
    @*<script src="~/Scripts/jquery.validate.min.js"></script>*@
    <script src="~/Scripts/jquery.maskedinput.min.js"></script>
    <script src="~/Scripts/jquery.previewimage.js"></script>
    <script src="~/Content/website/js/My97DatePicker/WdatePicker.js"></script>
    <script src="~/Content/website/address/area.js"></script>
    <script src="~/Content/website/address/location.js"></script>
    <script type="text/javascript">
        var cityIsLoaded = false;
        $(function () {
            $("#slAnswer").hover(function () {
                if ($(this).find("option").length == 1) {
                    layer.tips('您在选择答案前请先命题，并设置答案选项。', this, {
                        style: ['background-color:#014A97; color:#fff', '#014A97'],
                        maxWidth: 185,
                        time: 30,
                        //closeBtn: [0, true]
                        closeBtn: false
                    });
                }
            }, function () {
                layer.closeTips();
            });

            //初始化日期选择控件
            $(".launchtime").focus(function () {
                WdatePicker({ dateFmt: 'yyyy-MM-dd HH:mm:ss' })
            });

            //限制文本框只能输入数字
            $(".num").live("keyup", function () {
                $(this).val($(this).val().replace(/\D/g, ''));
            }).live("afterpaste", function () {
                $(this).val($(this).val().replace(/\D/g, ''));
            });

            // 开奖类型下拉框事件
            $("#slLauchType").change(function () {
                var thisvalue = $(this).val();
                var $opobj = $(this).find("option:selected");
                var rtype = $opobj.attr("rtype");
                //$("#hidnRevealType").val(thisvalue);
                $("#hidnRevealType").val(thisvalue);

                if (thisvalue == '@RevealType.Timing.ToInt()' || thisvalue == '@RevealType.Quota.ToInt()' || thisvalue == '@RevealType.Answer.ToInt()') {
                    locateScopeTypeSelect("");
                }
                if (thisvalue == '@RevealType.Answer.ToInt()') {
                    locateAnswerLauchTypeSelect("");
                }

                // 不是公用的部分先全部隐藏掉
                $("form#prizeForm tr[rtype!='no-change']").hide(); 
                if (rtype == "")
                    return;
                // 本抽奖类型相关的 表单项都现实出来
                $("form#prizeForm tr[rtype*='" + rtype + "']").fadeIn();

                @*if (thisvalue == "@RevealType.Answer.ToInt()") {
                    $.layer({
                        type: 1,
                        shade: [0.5, '#000'],
                        //shade: [0],
                        area: ['auto', 'auto'],
                        title: false,
                        border: [0],
                        page: { dom: '.layer_notice' }
                    });
                }*@
            });

            // 抽奖范围下拉框事件
            $("#slScopeType").change(function () {
                //$("#hidnScopeType").val($(this).val());
                $("#hidnScopeType").val($(this).val());
                if ($(this).val() == '@ScopeType.AreaCity.ToInt()') {
                    if (!cityIsLoaded) {
                        //地址下拉框联动
                        showLocation();
                        cityIsLoaded = true;
                    } else {
                        //初始化选中状态（什么都不选中）
                        var nullvalue = "";
                        locateProvinceSelect(nullvalue);
                    }
                }

                var $opobj = $(this).find("option:selected");
                var scopetype = $opobj.attr("scope-type");
                $("form#prizeForm tr[scope-type]").hide();
                if (scopetype != "") {
                    // 本抽奖类型相关的 表单项都现实出来
                    $("form#prizeForm tr[scope-type*='" + scopetype + "']").fadeIn();
                }
            });

            $("#slAnswerLauchType").change(function () {
                $("#hidnAnswerRevealConditionType").val($(this).val());

                var $opobj = $(this).find("option:selected");
                var ltcondition = $opobj.attr("lt-condition");
                $("form#prizeForm tr[lt-condition]").hide();
                if (ltcondition != "") {
                    // 本抽奖类型相关的 表单项都现实出来
                    $("form#prizeForm tr[lt-condition*='" + ltcondition + "']").fadeIn();
                }
            });

            $("#btnAddAnswerOption").click(function () {
                if ($("#txtAnswerOption").val() == "") {
                    layer.alert("答案不能为空", 8);
                    return;
                }

                //数字转字母
                var opcount = $("#slAnswer option[class='answer']").length;
                var opvalue = String.fromCharCode((opcount) + 65);
                var optionString = "<option class=\"answer\" value=" + opvalue + ">" + $("#txtAnswerOption").val() + "</option>"
                $("#listAnswerOptions").append(optionString)
                $("#slAnswer").append(optionString);
                $('.dropdown').append("<div class=\"dropdown-item\" value=" + opvalue + ">" + opvalue + ":" + $("#txtAnswerOption").val() + "<span>X</span></div>");
                $("#txtAnswerOption").val("");
            });

            $("#btnResetAnswerOption").click(function () {
                $("#slAnswer option[class='answer']").remove();
                $("div.dropdown div.dropdown-item").remove();
            });

            $("#txtAnswerOption").keypress(function (event) {
                var keycode = (event.keyCode ? event.keyCode : event.which);
                if (keycode == '13') {
                    $("#btnAddAnswerOption").trigger("click");
                }
            });

            $("div.dropdown-item").live("hover", function (event) {
                if (event.type == 'mouseenter') {
                    $(this).addClass("selected");
                    $(this).find("span").show();
                } else {
                    $(this).removeClass("selected");
                    $(this).find("span").hide();
                }
            });

            $("div.dropdown-item span").live("click", function () {
                var value = $(this).parent().attr("value");
                $(this).parent().remove();
                $("#slAnswer option[value=" + value + "]").remove();

                $('.dropdown div.dropdown-item').remove();
                var icounter = 0;
                $("#slAnswer option[class='answer']").each(function () {
                    //数字转字母
                    var opvalue = String.fromCharCode((icounter++) + 65);
                    $(this).attr("value", opvalue);
                    var divOPString = "<div class=\"dropdown-item\" value=" + opvalue + ">" + opvalue + ":" + $(this).html() + "<span>X</span></div>";
                    $('.dropdown').append(divOPString);
                });
            });

            $("#btnBrowerPhoto").click(function () {
                //文件上传
                //layer.prompt({ title: '随便上传个东东，并确认', type: 2 }, function (file) {
                //    console.debug(file);
                //    alert(file);
                //});
                $.layer({
                    type: 1,   //0-4的选择,
                    area: ['500px', '300px'],
                    shade: [0],  //不使用遮罩
                    maxmin: true,   //开启最小化/全屏
                    offset: ['100px', ''],
                    page: {
                        html: '<div><form action="intTpmsPurRegsn.do?action=uploadXls" enctype="multipart/form-data"><input type="file" name="xlsFile"/></form><input type="submit" value="提交"/></div>'
                    },
                    success: function () {
                        layer.shift('top'); //动画从上掉下
                    }
                });
            });

            $("#prizeForm").submit(function () {
                return true;
                //return false; //此处必须返回false，阻止常规的form提交
            });

            $("#btnSubmitForm").click(function () {
                var $form = $("#prizeForm");
                $("#PrizeName").rules("add", {
                    required: true,
                    messages: {
                        required: "奖品名称不能为空"
                    }
                });
                $("#PrizeDescription").rules("add", {
                    required: true,
                    messages: {
                        required: "奖品描述不能为空"
                    }
                });
                $("#slLauchType").rules("add", {
                    required: true,
                    messages: {
                        required: "开奖类型不能为空"
                    }
                });
                $("#slScopeType").rules("add", {
                    required: function () {
                        var rtype = $("#slLauchType").val();
                        if (rtype == '@RevealType.Scene.ToInt()')
                            return false;
                        return true;
                    },
                    messages: {
                        required: "抽奖范围不能为空"
                    }
                });
                $("#LuckyCount").rules("add", {
                    required: true,
                    digits: true,
                    messages: {
                        required: "中奖人数必须输入",
                        digits: "中奖人数只能是整数"
                    }
                });
                $("#LaunchTime").rules("add", {
                    required: function () {
                        var rtype = $("#slLauchType").val();
                        if (rtype == '@RevealType.Timing.ToInt()')
                                return true;
                            if (rtype == '@RevealType.Answer.ToInt()' && $("#slAnswerLauchType").val() == "1")
                            return true;
                        if (rtype == '@RevealType.Scene.ToInt()')
                            return true;
                        return false;
                    },
                    messages: {
                        required: "开奖时间不能为空"
                    }
                });
                $("#PoolCount").rules("add", {
                    required: function () {
                        var rtype = $("#slLauchType").val();
                        if (rtype == '@RevealType.Quota.ToInt()')
                                return true;
                            if (rtype == '@RevealType.Answer.ToInt()' && $("#slAnswerLauchType").val() == "2")
                            return true;
                        return false;
                    },
                    digits: true,
                    messages: {
                        required: "总人数必须输入",
                        digits: "总人数只能是整数"
                    }
                });
                $("#Question").rules("add", {
                    required: function () {//开奖问题
                        var rtype = $("#slLauchType").val();
                        if (rtype == '@RevealType.Answer.ToInt()')
                                return true;
                            return false;
                    },
                    messages: {
                        required: "必须输入"
                    }
                });
                $form.validate();
                if ($form.valid()) {
                    var rtype = $("#slLauchType").val();
                    if (rtype == '@RevealType.Scene.ToInt()') {
                        var options = "";
                        $("#slAnswer option[class='answer']").each(function () {
                            var value = $(this).val();
                            var text = $(this).html();
                            options += value + ":" + text + "|||";
                        });
                        if (options != "") {
                            options = options.substring(0, options.length - 3);
                        }
                        $("#hidnAnswerOptions").val(options);
                        $("hidnAnswer").val($("#slAnswer").val());
                    } else {
                        // 开奖城市名称
                        if ($("#slScopeType").val() == "@ScopeType.AreaCity.ToInt()") {
                            var province = $("select[name='loc_province']:eq(0)").find("option:selected").text();
                            var city = $("select[name='loc_city']:eq(0)").find("option:selected").text();
                            $("#hidnScopeAreaCity").val(city);
                            $("#hidnScopeProvince").val(province);
                        }
                    }
                    $form.submit();
                }
            });

            $("#prizeForm").validate({
                errorElement: 'span',
                errorClass: 'error-info',
                focusInvalid: false,
                rules: {
                    slAnswer: {
                        required: function () {//开奖答案
                            var rtype = $("#slLauchType").val();
                            if (rtype == '@RevealType.Answer.ToInt()')
                                return true;
                            return false;
                        },
                    },
                    AnswerLauchType: { //开奖条件
                        required: function () {
                            var rtype = $("#slLauchType").val();
                            if (rtype == '@RevealType.Answer.ToInt()')
                                return true;
                            return false;
                        },
                    },
                    loc_province: { //省份
                        required: function () {
                            var rtype = $("#slLauchType").val();
                            if (rtype == '@RevealType.Scene.ToInt()')
                                return false;
                            var scopeType = $("#slScopeType").val();
                            if (scopeType == "@ScopeType.Global.ToInt()")
                                return false;
                            return true;
                        }
                    },
                    loc_city: { //城市
                        required: function () {
                            var rtype = $("#slLauchType").val();
                            if (rtype == '@RevealType.Scene.ToInt()')
                                return false;
                            var scopeType = $("#slScopeType").val();
                            if (scopeType == "@ScopeType.Global.ToInt()")
                                return false;
                            return true;
                        }
                    },
                    _mvcCaptchaText: {
                        required: true
                    }
                },

                messages: {
                    slAnswer: {
                        required: "开奖答案必须选择"
                    },
                    AnswerLauchType: {
                        required: "开奖条件必须选择"
                    },
                    loc_province: {
                        required: "省份必须选择"
                    },
                    loc_city: {
                        required: "城市必须选择"
                    },
                    _mvcCaptchaText: {
                        required: "验证码不能为空"
                    }
                },
                invalidHandler: function (event, validator) { //display error alert on form submit   
                    //$('.alert-danger', $('.login-form')).show();
                },
                highlight: function (e) {
                    //$(e).closest('.form-group').removeClass('has-info').addClass('has-error');
                },
                /* 验证通过时的处理 */
                success: function (e, element) {
                    var $element = $(element);
                    if ($element.hasClass('select')) {
                        var slname = $element.attr("name");
                        var errorSpan = $("#prizeForm span[for=" + slname + "]:eq(0)");
                        var br = errorSpan.prev("br");
                        if (br != null) {
                            br.remove();
                        }
                    }
                },
                /* 错误信息的显示位置 */
                errorPlacement: function (error, element) {
                    if (element.hasClass('select')) {
                        element.parent().append("<br />");
                    } 
                    error.appendTo(element.parent());
                }
                , onfocusout: function (element) {
                    $(element).valid();
                }
                /*执行ajaxsubmit*/
                //, submitHandler: function (form) {
                //}
            });

            $("#photoForm").submit(function () {
                var loadi;
                $(this).ajaxSubmit({
                    type: "post",
                    //dataType: "xml", //期望返回的数据类型。null、“xml”、“script”或者“json”其中之一
                    //url: "test_save.php?time=" + (new Date()).getTime(),
                    beforeSubmit: function () {
                        loadi = layer.load('正在上传图片，请耐心等待…');
                    },
                    success: function (data) {
                        var result = data.OK;
                        var message = data.Message;
                        if (!result) {
                            layer.alert(message, 8);
                            return;
                        }
                        layer.alert(message, 9);
                    },
                    error: function () {

                    },
                    complete: function () {
                        layer.close(loadi);
                    }
                });
                return false;
            });

            $("#prizePhoto").PreviewImage({
                ImageClientId: "imgHeadPhoto",
                MaxWidth: 300,
                MaxHeight: 200,
                DivPreviewId: "divPreview",
                AllowExtention: ".jpg,.bmp,.gif,.png"
            });

            // 初始化选中抽奖类型
            var rtype = "@ViewBag.RevealType";
            locateRTypeSelect(rtype);

            if (rtype != "" && rtype != null && rtype != "@RevealType.Scene.ToInt()") {
                // 抽奖范围
                var stype = "@ViewBag.ScopeType";
                locateScopeTypeSelect(stype);
                if (stype == "@ScopeType.AreaCity.ToInt()") {
                    var province = "@ViewBag.ScopeProvince";
                    var city = "@ViewBag.ScopeCity";
                    locateProvinceSelectByText(province);
                    locateScopeCitySelectByText(city);
                }
            }
        });

        function locateRTypeSelect(value) {
            var $select = $("#slLauchType");
            locateSelect($select, value);
        }

        function locateScopeTypeSelect(value) {
            var $select = $("#slScopeType");
            locateSelect($select, value);
        }

        function locateProvinceSelect(value) {
            var $select = $("select[name='loc_province']").eq(0);
            locateSelect($select, value);
        }

        function locateProvinceSelectByText(text) {
            var $select = $("select[name='loc_province']").eq(0);
            var value = $select.find("option[text='" + text + "']:eq(0)").val();
            locateSelect($select, value);
        }

        function locateScopeCitySelect(value) {
            var $select = $("select[name='loc_city']").eq(0);
            locateSelect($select, value);
        }

        function locateScopeCitySelectByText(text) {
            var $select = $("select[name='loc_city']").eq(0);
            var value = $select.find("option[text='" + text + "']:eq(0)").val();
            locateSelect($select, value);
        }

        function locateAnswerLauchTypeSelect(value) {
            var $select = $("#slAnswerLauchType");
            locateSelect($select, value);
        }

        function locateSelect(select, value) {
            var $select = select;
            $select.find("option").each(function () {
                var $option = $(this);
                var rtvalue = $option.val();

                if ($.trim(rtvalue) == value) {
                    $option.attr("selected", true);
                    $select.trigger("change");
                    return false; // false时相当于break, 如果return true 就相当于continure。
                }
            });
        }
    </script>
}
@section  styles{
    <style type="text/css">
        body {
            behavior: url("../../../Content/website/css/csshover.htc");
        }

        div.row-container {
        }

        div.formdata {
            display: none;
        }

        input[type=text].num {
            width: 30px;
        }

        /*发起抽奖页面*/
        div.dropdown {
            height: 200px;
            width: 200px;
            overflow-y: scroll;
            border: solid 1px silver;
            padding: 5px;
        }

            div.dropdown .dropdown-item {
                cursor: pointer;
                position: relative;
            }

                div.dropdown .dropdown-item:hover {
                    background: #C6D7EF;
                    color: #000;
                }

            div.dropdown span {
                position: absolute;
                right: 5px;
                display: none;
            }

                div.dropdown span:hover {
                    color: #f00;
                    font-weight: bold;
                }

            div.dropdown .selected {
                background: #C6D7EF;
                color: #000;
            }

        .layer_notice {
            float: left;
            height: 75px;
            width: 330px;
            overflow: hidden;
            color: #fff;
            background: #014A97;
            padding: 10px;
            border: 1px solid #000066;
        }

            .layer_notice li {
                line-height: 25px;
                list-style: none;
            }

            .layer_notice label {
                font-size: 14px;
            }
    </style>
}